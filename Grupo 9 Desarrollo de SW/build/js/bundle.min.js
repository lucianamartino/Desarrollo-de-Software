let filesList=[];const classDragOver="drag-over",fileInputMulti=document.querySelector("#multi-selector-uniq #foto"),multiSelectorUniqPreview=document.querySelector("#multi-selector-uniq #preview");function getIndexOfFileList(e,t){return t.reduce(((t,i,n)=>i.name===e?n:t),-1)}async function encodeFileToText(e){return e.text().then((e=>e))}async function getUniqFiles(e,t){return new Promise((i=>{Promise.all(e.map((e=>encodeFileToText(e)))).then((n=>{Promise.all(t.map((e=>encodeFileToText(e)))).then((r=>{let l=t;n.forEach(((t,i)=>{r.includes(t)||(l=l.concat(e[i]))})),i(l)}))}))}))}function renderPreviews(e,t,i){t.textContent="",e.forEach(((n,r)=>{const l=document.createElement("li");l.textContent=n.name,l.setAttribute("draggable","true"),l.dataset.key=n.name,l.addEventListener("drop",eventDrop),l.addEventListener("dragover",eventDragOver);const s=document.createElement("button");s.textContent="X",s.addEventListener("click",(()=>(filesList=deleteArrayElementByIndex(e,r),i.files=arrayFilesToFileList(filesList),renderPreviews(filesList,multiSelectorUniqPreview,i)))),l.appendChild(s),t.appendChild(l)}))}function deleteArrayElementByIndex(e,t){return e.filter(((e,i)=>i!==t))}function arrayFilesToFileList(e){return e.reduce((function(e,t){return e.items.add(t),e}),new DataTransfer).files}function arraySwapIndex(e,t,i){const n=i.slice(),r=n[e];return n[e]=n[t],n[t]=r,n}let myDragElement;function eventDragOver(e){e.preventDefault(),multiSelectorUniqPreview.querySelectorAll("li").forEach((e=>e.classList.remove("drag-over"))),e.target.classList.add("drag-over")}function eventDrop(e){const t=e.target;filesList=arraySwapIndex(getIndexOfFileList(myDragElement.dataset.key,filesList),getIndexOfFileList(t.dataset.key,filesList),filesList),fileInputMulti.files=arrayFilesToFileList(filesList),renderPreviews(filesList,multiSelectorUniqPreview,fileInputMulti)}fileInputMulti.addEventListener("input",(async()=>{const e=Array.from(fileInputMulti.files);filesList=await getUniqFiles(e,filesList),renderPreviews(filesList,multiSelectorUniqPreview,fileInputMulti),fileInputMulti.files=arrayFilesToFileList(filesList)})),document.addEventListener("dragstart",(e=>{myDragElement=e.target})),fileInputMulti.addEventListener("input",(async()=>{const e=Array.from(fileInputMulti.files),t=["image/jpg","image/jpeg","image/png","image/webp"],i=e.filter((e=>t.includes(e.type)));e.filter((e=>!t.includes(e.type))).length>0&&alert("Por favor, selecciona solo archivos de imagen (JPG, JPEG, PNG, WEBP)."),i.length>0?(filesList=await getUniqFiles(i,filesList),renderPreviews(filesList,multiSelectorUniqPreview,fileInputMulti),fileInputMulti.files=arrayFilesToFileList(filesList)):fileInputMulti.value=""}));
//# sourceMappingURL=bundle.js.map
